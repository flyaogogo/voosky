<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="article">

	<typeAlias alias="Article"
		type="com.tmwrk.voosky.database.vo.Article" />

	<resultMap id="articleMap" class="Article">
		<result property="id" column="id" />
		<result property="cateId" column="cat_id" />
		<result property="title" column="title" />
		<result property="isRecommend" column="is_recommend" />
		<result property="content" column="content" />
		<result property="thumbUrl" column="thumb_url" />
		<result property="keywords" column="keywords" />
		<result property="desc" column="description" />
		<result property="clickNum" column="clicknum" />
		<result property="addTime" column="add_time" />
		<result property="vsort" column="vsort" />
	</resultMap>
	
	<select id="getAllArticles" parameterClass="java.util.HashMap" resultMap="articleMap">
		select id,cat_id,title,is_recommend,content,thumb_url,keywords,description,clicknum,
			add_time,vsort from vs_article where 1=1
			<isNotNull property="isRecommend">
				and is_recommend = #isRecommend#
			</isNotNull>
			<isNotNull property="cateId">
				and cat_id = #cateId#
			</isNotNull>
			<isNotNull property="title">
				and title like concat('%', #title#, '%')
			</isNotNull>
	</select>
	<select id="getArticleById" parameterClass="java.util.HashMap" resultMap="articleMap">
		select id,cat_id,title,is_recommend,content,thumb_url,keywords,description,clicknum,
			add_time,vsort from vs_article where id=#id#
	</select>
	
	<insert id="addArticle" parameterClass="Article">
		insert into vs_article(id,cat_id,title,is_recommend,content,thumb_url,keywords,description,clicknum,add_time,vsort) 
		values ((select ifnull(max(vsp.id)+1,1) from vs_article vsp),#cateId#,#title#,#isRecommend#,#content#,#thumbUrl#,
			#keywords#,#desc#,#clickNum#,#addTime#,#vsort#)
	</insert>
	
	<update id="updateById" parameterClass="Article">
		update vs_article set cat_id=#cateId#,title=#title#,is_recommend=#isRecommend#,content=#content#,thumb_url=#thumbUrl#,
			keywords=#keywords#,description=#desc#,vsort=#vsort# where id=#id#
	</update>
	
	<update id="updateShowFirstPageById" parameterClass="Article">
		update vs_article set is_recommend=#isRecommend# where id=#id#
	</update>
	
	<delete id="deleteById" parameterClass="Article">
		delete from vs_article where id=#id#
	</delete>
	
</sqlMap>